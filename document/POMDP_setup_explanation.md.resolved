# コード設定仕様: POMDPモデル定義

ご提示いただいたコードブロックで設定されている、環境とエージェントの全パラメータ設定のまとめです。

## 1. 空間と次元の設定

| 変数名 | 値 | 意味 |
| :--- | :--- | :--- |
| `x_division` | **10** | 廊下の幅（X軸） |
| `y_division` | **20** | 廊下の長さ（Y軸） |
| `col_division` | **10** | エージェント間距離の認識段階（0=衝突 〜 9=遠い） |
| `actiondivision` | **3** | 行動の種類（各軸）。`0:静止`, `1:正方向(+1)`, `2:負方向(-1)` |

---

## 2. エージェントの認識構造（POMDP）

### 隠れ状態 (Hidden States)
エージェントが推論する**8つの状態因子**。
`num_states = [10, 20, 3, 3, 10, 20, 3, 3]`

1.  **自分**: `X座標(10)`, `Y座標(20)`, `X行動(3)`, `Y行動(3)`
2.  **相手**: `X座標(10)`, `Y座標(20)`, `X行動(3)`, `Y行動(3)`

### 観測 (Observations)
エージェントが受け取る**9つの感覚情報**。
`num_obs = [..., 10]`

1.  **直接観測**: 隠れ状態の8つは、そのままノイズ付きで観測可能。
2.  **衝突距離 (Modality 8)**: `10`段階。自分と相手の位置関係から算出される。

---

## 3. モデル行列の設定詳細

### A行列（認識モデル）
*   **依存関係**:
    *   距離以外のモダリティは、対応する状態因子と **1対1**。
    *   **距離モダリティ**は、`[自分X, 自分Y, 相手X, 相手Y]` の **4対1** 接続。
*   **設定ロジック**:
    *   ユークリッド距離 $d = \sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}$ を計算。
    *   距離を `int(d * 2)` でインデックス化し、最大9で打ち切り。
    *   つまり、**物理的な近さを「距離感」として学習済み**の状態（pAに加算）として初期化。

### B行列（物理法則モデル）
*   **依存関係**: 各因子は独立して遷移。
*   **移動ロジック (`np.roll`)**:
    *   行動インデックス `1` の時: 座標分布を **+1 シフト**（右/下へ移動）。
    *   行動インデックス `2` の時: 座標分布を **-1 シフト**（左/上へ移動）。
    *   行動 `0` の時は維持。
*   **意味**: 「右に動く行動をとれば、次の時刻には右にいる」という常識を初期値(pB)として持っている。

### C行列（ゴール・選好）
エージェントの目的関数 (`M_PREF = -0.2` でコストのベースライン設定)。

| Agent | 項目 | 設定内容 (分布形状) | 意味 |
| :--- | :--- | :--- | :--- |
| **0** | **Y位置** | `-1` から `20` への線形増加 | **上端 (Y=19) に行きたい** |
| | **X位置** | 中央が高い放物線 | 真ん中 (X=5付近) を通りたい |
| | **衝突距離** | `-1` から `8` への線形増加 | **距離をとりたい（衝突回避）** |
| | **相手Y** | `20` から `-1` への線形減少 | 相手には下端 (Y=0) にいてほしい |
| **1** | **Y位置** | `20` から `-1` への線形減少 | **下端 (Y=0) に行きたい** |
| | (他) | Agent 0 と対称設定 | |

### D行列（初期信念）
*   全ての状態について **一様分布 (Uniform)** で初期化。
*   「最初はどこにいるか、相手が誰か、何もわからない」状態からスタート。

---

## 4. 行動計画 (Policies)

*   **構造**: 自分の行動だけでなく、**相手の行動も含む8次元ベクトル**のリスト。
*   **サイズ**: `3(自X) * 2(自Y) * 3(他X) * 2(他Y)` の組み合わせ。
    *   Y方向の行動を `[1, 2]` (Agent0) や `[0, 1]` (Agent1) に限定することで、あらかじめ「目的地に向かう」こと前提のプランのみを探索対象に絞っている（計算量削減）。

## 5. その他パラメータ

*   **Alpha (注意の配分)**:
    *   `instAlpha = 0.5`
    *   自分関連のモダリティと、相手関連のモダリティの信頼度（Precision）を半々に設定。
